import{r as b,b as r,j as e,i as N,y as s,c as h}from"./index-CT1dYHP2.js";import{M as v}from"./index-DsbIybjs.js";const C=()=>{const[a,c]=b.useState({name:"",image:[],unit:"",stock:"",price:"",discount:"",description:"",more_details:"{}",publish:!0}),[m,g]=b.useState(!1),i=l=>{c({...a,[l.target.name]:l.target.value})},f=async l=>{const o=l.target.files;if(!(o!=null&&o.length))return;g(!0);const d="dsho1poyl",n="ml_unsigned",t=[...a.image];try{await Promise.all(Array.from(o).map(async u=>{const p=new FormData;p.append("file",u),p.append("upload_preset",n);const y=await h.post(`https://api.cloudinary.com/v1_1/${d}/image/upload`,p);t.push(y.data.secure_url)})),s.success("¡Imágenes subidas!")}catch{s.error("Error subiendo imágenes")}c(u=>({...u,image:t})),g(!1)},x=l=>{c(o=>({...o,image:o.image.filter((d,n)=>n!==l)}))};return r("div",{className:"max-w-[1000px] mx-auto my-8 p-8 bg-white rounded-xl shadow-lg",children:[r("header",{className:"text-center mb-8",children:[e("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Nuevo Producto"}),e("p",{className:"text-gray-600",children:"Registra los detalles de tu producto"})]}),r("form",{onSubmit:async l=>{var d,n;l.preventDefault();const o=sessionStorage.getItem("authToken");if(!o){s.error("Inicia sesión primero");return}if(a.image.length===0)return s.warn("Sube al menos 1 imagen");if(a.discount>100||a.discount<0)return s.error("Descuento inválido");try{const t={...a,category_id:4,stock:Number(a.stock),price:Number(a.price),discount:Number(a.discount),more_details:JSON.parse(a.more_details)};await h.post("https://cloudflare-d1.ujhuji.workers.dev/api/products",t,{headers:{Authorization:`Bearer ${o}`,"Content-Type":"application/json"}}),s.success("✔ Producto creado!"),c({name:"",image:[],unit:"",stock:"",price:"",discount:"",description:"",more_details:"{}",publish:!0})}catch(t){console.error("Error:",t),s.error(((n=(d=t.response)==null?void 0:d.data)==null?void 0:n.error)||"Error desconocido")}},className:"flex flex-col gap-8",children:[r("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[r("div",{className:"flex flex-col gap-6",children:[r("div",{className:"flex flex-col gap-3",children:[e("label",{className:"text-sm font-semibold text-gray-800",children:"Nombre del Producto*"}),e("input",{name:"name",value:a.name,onChange:i,className:"w-full p-3 border border-gray-300 rounded-lg bg-gray-50 focus:outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-200",placeholder:"Ej: Zapatos deportivos",required:!0})]}),r("div",{className:"flex flex-col gap-3",children:[e("label",{className:"text-sm font-semibold text-gray-800",children:"Precio (USD)*"}),r("div",{className:"relative",children:[e("span",{className:"absolute left-3 top-1/2 -translate-y-1/2 text-gray-600",children:"$"}),e("input",{type:"number",name:"price",value:a.price,onChange:i,className:"w-full p-3 pl-8 border border-gray-300 rounded-lg bg-gray-50 focus:outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-200",min:"0",step:"0.01",required:!0})]})]}),r("div",{className:"flex flex-col gap-3",children:[e("label",{className:"text-sm font-semibold text-gray-800",children:"Descuento (%)"}),e("input",{type:"number",name:"discount",value:a.discount,onChange:i,className:"w-full p-3 border border-gray-300 rounded-lg bg-gray-50 focus:outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-200",min:"0",max:"100",placeholder:"0-100%"})]})]}),r("div",{className:"flex flex-col gap-6",children:[r("div",{className:"flex flex-col gap-3",children:[e("label",{className:"text-sm font-semibold text-gray-800",children:"Stock Disponible*"}),e("input",{type:"number",name:"stock",value:a.stock,onChange:i,className:"w-full p-3 border border-gray-300 rounded-lg bg-gray-50 focus:outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-200",min:"0",placeholder:"Cantidad en inventario",required:!0})]}),r("div",{className:"flex flex-col gap-3",children:[e("label",{className:"text-sm font-semibold text-gray-800",children:"Unidad de Medida*"}),r("select",{name:"unit",value:a.unit,onChange:i,className:"w-full p-3 border border-gray-300 rounded-lg bg-gray-50 focus:outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-200 appearance-none",required:!0,children:[e("option",{value:"",children:"Seleccionar unidad"}),e("option",{value:"unidad",children:"Unidad"}),e("option",{value:"par",children:"Par"}),e("option",{value:"kg",children:"Kilogramo"}),e("option",{value:"litro",children:"Litro"})]})]}),r("div",{className:"flex flex-col gap-3",children:[e("label",{className:"text-sm font-semibold text-gray-800",children:"Estado"}),r("div",{className:"flex items-center gap-3",children:[r("label",{className:"relative inline-block w-12 h-7",children:[e("input",{type:"checkbox",checked:a.publish,onChange:l=>c(o=>({...o,publish:l.target.checked})),className:"opacity-0 w-0 h-0 peer"}),e("span",{className:"absolute cursor-pointer top-0 left-0 right-0 bottom-0 bg-gray-200 rounded-full transition-all duration-300 before:absolute before:h-5 before:w-5 before:left-1 before:bottom-1 before:bg-white before:rounded-full before:transition-all before:duration-300 peer-checked:bg-blue-500 peer-checked:before:left-6"})]}),e("span",{className:"text-sm text-gray-700",children:a.publish?"Público":"Oculto"})]})]})]})]}),r("div",{className:"flex flex-col gap-3",children:[e("label",{className:"text-sm font-semibold text-gray-800",children:"Descripción Detallada*"}),e("textarea",{name:"description",value:a.description,onChange:i,className:"w-full p-3 border border-gray-300 rounded-lg bg-gray-50 focus:outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-200 h-32 resize-y",placeholder:"Describe características principales del producto",required:!0})]}),r("div",{className:"flex flex-col gap-3",children:[e("label",{className:"text-sm font-semibold text-gray-800",children:"Imágenes del Producto*"}),r("div",{className:"border-2 border-dashed border-gray-300 rounded-xl p-8 flex flex-col items-center justify-center cursor-pointer bg-gray-50 hover:border-blue-500 hover:bg-blue-50 transition-colors min-h-[180px]",onClick:()=>document.getElementById("fileInput").click(),children:[e(N,{className:"text-4xl text-gray-600 mb-4"}),r("div",{className:"text-center",children:[e("p",{className:"text-gray-900 font-medium",children:m?"Subiendo archivos...":"Arrastra tus imágenes aquí"}),e("p",{className:"text-gray-600 text-sm mt-1",children:"Formatos soportados: PNG, JPG (Máx. 10MB)"})]}),e("input",{type:"file",id:"fileInput",hidden:!0,multiple:!0,onChange:f,accept:"image/*"})]}),e("div",{className:"grid grid-cols-[repeat(auto-fill,minmax(150px,1fr))] gap-4 mt-6",children:a.image.map((l,o)=>r("div",{className:"relative rounded-lg overflow-hidden shadow-md hover:translate-y-[-2px] transition-transform",children:[e("img",{src:l,alt:`Vista previa ${o}`,className:"w-full h-36 object-cover"}),e("button",{type:"button",className:"absolute top-2 right-2 bg-white/90 rounded-full p-1 shadow-sm hover:bg-white",onClick:()=>x(o),children:e(v,{className:"text-red-600 text-xl"})})]},o))})]}),e("button",{type:"submit",className:"w-full p-4 bg-blue-500 text-white rounded-lg font-semibold hover:bg-blue-600 transition-colors disabled:opacity-70 disabled:cursor-not-allowed",disabled:m,children:m?"Publicando...":"Publicar Producto"})]})]})};export{C as default};
